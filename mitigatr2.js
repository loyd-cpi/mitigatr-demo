function mitigatrBtn(){var e=document.getElementById("luckysheet"),t=document.getElementById("injecteddiv");"-100%"===e.style.top?(e.style.top="0px",t.style.top="0px"):(e.style.top="-100%",t.style.top="-100%")}function mitigatrHandler(){let e=document.getElementById("Luckyexcel-demo-file"),t=document.getElementById("Luckyexcel-select-demo"),n=document.getElementById("Luckyexcel-downlod-file"),i=document.getElementById("lucky-mask-demo");e&&(window.onload=(()=>{e.addEventListener("change",function(e){var t=e.target.files;if(null==t||0==t.length)return void alert("No files wait for import");let n=t[0].name.split(".");"xlsx"==n[n.length-1]?LuckyExcel.transformExcelToLucky(t[0],function(e,t){null!=e.sheets&&0!=e.sheets.length?(window.luckysheet.destroy(),window.luckysheet.create({container:"luckysheet",showinfobar:!1,data:e.sheets,title:e.info.name,userInfo:e.info.name.creator})):alert("Failed to read the content of the excel file, currently does not support xls files!")}):alert("Currently only supports the import of xlsx files")}),t.addEventListener("change",function(e){var n=t,o=n.selectedIndex,l=n.options[o].value,d=n.options[o].innerHTML;""!=l&&(i.style.display="flex",LuckyExcel.transformExcelToLuckyByUrl(l,d,function(e,t){null!=e.sheets&&0!=e.sheets.length?(i.style.display="none",window.luckysheet.destroy(),window.luckysheet.create({container:"luckysheet",showinfobar:!1,data:e.sheets,title:e.info.name,userInfo:e.info.name.creator})):alert("Failed to read the content of the excel file, currently does not support xls files!")}))}),n.addEventListener("click",function(e){var n=t,i=n.selectedIndex,o=n.options[i].value;if(0!=o.length){var l=document.getElementById("Lucky-download-frame");null==l&&((l=document.createElement("iframe")).style.display="none",l.id="Lucky-download-frame",document.body.appendChild(l)),l.src=o}else alert("Please select a demo file")})}))}function loadStyle(e){return new Promise(function(t,n){let i=document.createElement("link");i.href=e,i.rel="stylesheet",i.onload=(()=>t(i)),i.onerror=(()=>n(new Error(`Style load error for ${e}`))),document.head.append(i)})}mitigatrHandler();let didInject=!1;function injectResources(){loadStyle("https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/plugins/css/pluginsCss.css").then(()=>loadStyle("https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/plugins/plugins.css")).then(()=>loadStyle("https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/css/luckysheet.css")).then(()=>loadStyle("https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/assets/iconfont/iconfont.css")).catch(e=>console.log(e));const e=document.createElement("style");var t,n;e.textContent=".injectedlogo{height:26px;display:inline;padding-right:12px;padding-top:4px}.injecteda{display:inline}.injecteddiv{height:20px;position:relative;z-index:101;margin:0;position:absolute;top:-100%;z-index:100;margin-left:auto;margin-right:auto;transform:translate(15vh,85vh);margin-top:67px;border-left:3px solid red;transition:.4s;display:table-cell;vertical-align:middle}.injectedinput{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1;padding:2px}.injectedinput+label{margin-top:8px;font-size:1.25em;border-top-right-radius:5px;padding-left:10px;padding-right:10px;padding-top:1px;font-weight:700;color:#fff;background-color:red;display:inline-block}.injectedinput+label:hover,.injectedinput:focus+label{background-color:red}",document.head.append(e),t=document,(n=t.createElement("script")).type="text/javascript",n.async=!0,n.onload=function(){mitigatrLoadedScripts()},n.src="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/plugins/js/plugin.js",t.getElementsByTagName("head")[0].appendChild(n),function(e,t){(t=e.createElement("script")).type="text/javascript",t.async=!0,t.onload=function(){mitigatrLoadedScripts()},t.src="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/luckysheet.umd.js",e.getElementsByTagName("head")[0].appendChild(t)}(document),function(e,t){(t=e.createElement("script")).type="text/javascript",t.async=!0,t.onload=function(){mitigatrLoadedScripts()},t.src="https://cdn.jsdelivr.net/npm/luckyexcel/dist/luckyexcel.umd.js",e.getElementsByTagName("head")[0].appendChild(t)}(document)}document.addEventListener("DOMContentLoaded",()=>{injectResources(),didInject=!0}),setTimeout(function(){0==didInject&&(injectResources(),didInject=!0)},3e3);let mitigatrScrCount=0;function mitigatrLoadedScripts(){3==++mitigatrScrCount&&$(function(){document.body.innerHTML+='<div>\n        <div id="luckysheet" style="margin:0px;padding:0px;width:85vw;height:85vh;position:absolute;top:-100%;z-index:100;margin-left:auto;margin-right:auto;transform:translate(15vh,93px);border:3px solid red;border-top:0px;box-shadow:2px 2px 100px 6px #888888;transition:400ms;"></div>\n          <div class="injecteddiv" id="injecteddiv">\n            <input accept=".xlsx" class="injectedinput" type="file" id="Luckyexcel-demo-file" name="Luckyexcel-demo-file">\n            <label for="Luckyexcel-demo-file">Choose a file</label>\n          </div>\n        </div>\n      </div>',document.querySelector("#quick_search_menu").insertAdjacentHTML("beforeBegin",'<a class="injecteda" onclick="mitigatrBtn()"><img src="https://raw.githubusercontent.com/loyd-cpi/mitigatr-demo/main/logo_mitigatr_white_web-w-1.png" class="injectedlogo"></a>');luckysheet.create({container:"luckysheet",allowCopy:!0,showtoolbar:!0,showinfobar:!0,data:[{name:"Sheet1",color:"red",status:"1",order:"0",data:[],config:{},index:0}]})})}
