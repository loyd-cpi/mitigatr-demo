function mitigatrBtn(){var e=document.getElementById("luckysheet"),t=document.getElementById("injecteddiv");"-100%"===e.style.top?(e.style.top="0px",t.style.top="0px"):(e.style.top="-100%",t.style.top="-100%")}function mitigatrHandler(){let e=document.getElementById("Luckyexcel-demo-file"),t=document.getElementById("Luckyexcel-select-demo"),n=document.getElementById("Luckyexcel-downlod-file"),o=document.getElementById("lucky-mask-demo");e&&(window.onload=(()=>{e.addEventListener("change",function(e){var t=e.target.files;if(null==t||0==t.length)return void alert("No files wait for import");let n=t[0].name.split(".");"xlsx"==n[n.length-1]?LuckyExcel.transformExcelToLucky(t[0],function(e,t){null!=e.sheets&&0!=e.sheets.length?(window.luckysheet.destroy(),window.luckysheet.create({container:"luckysheet",showinfobar:!1,data:e.sheets,title:e.info.name,userInfo:e.info.name.creator})):alert("Failed to read the content of the excel file, currently does not support xls files!")}):alert("Currently only supports the import of xlsx files")}),t.addEventListener("change",function(e){var n=t,i=n.selectedIndex,s=n.options[i].value,l=n.options[i].innerHTML;""!=s&&(o.style.display="flex",LuckyExcel.transformExcelToLuckyByUrl(s,l,function(e,t){null!=e.sheets&&0!=e.sheets.length?(o.style.display="none",window.luckysheet.destroy(),window.luckysheet.create({container:"luckysheet",showinfobar:!1,data:e.sheets,title:e.info.name,userInfo:e.info.name.creator})):alert("Failed to read the content of the excel file, currently does not support xls files!")}))}),n.addEventListener("click",function(e){var n=t,o=n.selectedIndex,i=n.options[o].value;if(0!=i.length){var s=document.getElementById("Lucky-download-frame");null==s&&((s=document.createElement("iframe")).style.display="none",s.id="Lucky-download-frame",document.body.appendChild(s)),s.src=i}else alert("Please select a demo file")})}))}function loadStyle(e){return new Promise(function(t,n){let o=document.createElement("link");o.href=e,o.rel="stylesheet",o.onload=(()=>t(o)),o.onerror=(()=>n(new Error(`Style load error for ${e}`))),document.head.append(o)})}mitigatrHandler();let didInject=!1;function injectResources(){var e=document.createElement("meta");e.httpEquiv="Content-Security-Policy",e.content="default-src 'self' https://cdn.jsdelivr.net",document.getElementsByTagName("head")[0].appendChild(e),$.ajax("https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/plugins/css/pluginsCss.css",{success:e=>{const t=document.createElement("style");t.textContent=e,document.head.append(t)},error:e=>{console.log("error loading pluginsCss.css")}}),$.ajax("https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/plugins/plugins.css",{success:e=>{const t=document.createElement("style");t.textContent=e,document.head.append(t)},error:e=>{console.log("error loading plugins.css")}}),$.ajax("https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/css/luckysheet.css",{success:e=>{const t=document.createElement("style");t.textContent=e,document.head.append(t)},error:e=>{console.log("error loading luckysheet.css")}}),$.ajax("https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/assets/iconfont/iconfont.css",{success:e=>{const t=document.createElement("style");t.textContent=e,document.head.append(t)},error:e=>{console.log("error loading iconfont.css")}});const t=document.createElement("style");var n,o;t.textContent=".injectedlogo{height:26px;display:inline;padding-right:12px;padding-top:4px}.injecteda{display:inline}.injecteddiv{height:20px;position:relative;z-index:101;margin:0;position:absolute;top:-100%;z-index:100;margin-left:auto;margin-right:auto;transform:translate(15vh,85vh);margin-top:67px;border-left:3px solid red;transition:.4s;display:table-cell;vertical-align:middle}.injectedinput{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1;padding:2px}.injectedinput+label{margin-top:8px;font-size:1.25em;border-top-right-radius:5px;padding-left:10px;padding-right:10px;padding-top:1px;font-weight:700;color:#fff;background-color:red;display:inline-block}.injectedinput+label:hover,.injectedinput:focus+label{background-color:red}",document.head.append(t),n=document,o="script",(o=n.createElement("script")).type="text/javascript",o.async=!0,o.onload=function(){mitigatrLoadedScripts()},o.src="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/plugins/js/plugin.js",n.getElementsByTagName("head")[0].appendChild(o),function(e,t){(t=e.createElement("script")).type="text/javascript",t.async=!0,t.onload=function(){mitigatrLoadedScripts()},t.src="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/luckysheet.umd.js",e.getElementsByTagName("head")[0].appendChild(t)}(document,"script"),function(e,t){(t=e.createElement("script")).type="text/javascript",t.async=!0,t.onload=function(){mitigatrLoadedScripts()},t.src="https://cdn.jsdelivr.net/npm/luckyexcel/dist/luckyexcel.umd.js",e.getElementsByTagName("head")[0].appendChild(t)}(document,"script")}document.addEventListener("DOMContentLoaded",()=>{injectResources(),didInject=!0}),setTimeout(function(){0==didInject&&(injectResources(),didInject=!0)},3e3);let mitigatrScrCount=0;function mitigatrLoadedScripts(){3==++mitigatrScrCount&&$(function(){document.body.innerHTML+='<div>\n        <div id="luckysheet" style="margin:0px;padding:0px;width:85vw;height:85vh;position:absolute;top:-100%;z-index:100;margin-left:auto;margin-right:auto;transform:translate(15vh,93px);border:3px solid red;border-top:0px;box-shadow:2px 2px 100px 6px #888888;transition:400ms;"></div>\n          <div class="injecteddiv" id="injecteddiv">\n            <input accept=".xlsx" class="injectedinput" type="file" id="Luckyexcel-demo-file" name="Luckyexcel-demo-file">\n            <label for="Luckyexcel-demo-file">Choose a file</label>\n          </div>\n        </div>\n      </div>',document.querySelector("#quick_search_menu").insertAdjacentHTML("beforeBegin",'<a class="injecteda" onclick="mitigatrBtn()"><img src="https://raw.githubusercontent.com/loyd-cpi/mitigatr-demo/main/logo_mitigatr_white_web-w-1.png" class="injectedlogo"></a>');luckysheet.create({container:"luckysheet",allowCopy:!0,showtoolbar:!0,showinfobar:!0,data:[{name:"Sheet1",color:"red",status:"1",order:"0",data:[],config:{},index:0}]})})}
